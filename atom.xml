<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[dofa blog]]></title>
  <link href="http://dofa.org/atom.xml" rel="self"/>
  <link href="http://dofa.org/"/>
  <updated>2014-02-26T08:45:18+00:00</updated>
  <id>http://dofa.org/</id>
  <author>
    <name><![CDATA[dofa]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[vim思维导图]]></title>
    <link href="http://dofa.org/blog/2014/02/26/vim-mind-mapping/"/>
    <updated>2014-02-26T16:42:52+00:00</updated>
    <id>http://dofa.org/blog/2014/02/26/vim-mind-mapping</id>
    <content type="html"><![CDATA[<p><img src="http://dofa.u.qiniudn.com/image/vim/vim-mind-mapping.png"></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Octopress发生titlecase error]]></title>
    <link href="http://dofa.org/blog/2014/02/24/occurs-titlecase-error-in-octopress/"/>
    <updated>2014-02-24T13:25:52+00:00</updated>
    <id>http://dofa.org/blog/2014/02/24/occurs-titlecase-error-in-octopress</id>
    <content type="html"><![CDATA[<p>把_config.yml中的</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>titlecase: true</span></code></pre></td></tr></table></div></figure>


<p>修改为：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>titlecase: false  </span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[为 Octopress 添加多说评论系统]]></title>
    <link href="http://dofa.org/blog/2014/02/24/add-duoshuo-commemt-system-into-octopress/"/>
    <updated>2014-02-24T08:49:29+00:00</updated>
    <id>http://dofa.org/blog/2014/02/24/add-duoshuo-commemt-system-into-octopress</id>
    <content type="html"><![CDATA[<p>disqus是国外的评论系统，速度实在太慢，使用duoshuo会比较好</p>

<h2>修改配置</h2>

<p>在_config.yml中注释掉有关disqus的配置，增加：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># duoshuo comments
</span><span class='line'>duoshuo_comments: true
</span><span class='line'>duoshuo_short_name: yourname</span></code></pre></td></tr></table></div></figure>


<h2>修改post模板</h2>

<p>在 source/_layouts/post.html 中的 disqus代码下下方添加多说评论模块</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>{% if site.duoshuo_short_name and site.duoshuo_comments == true and page.comments == true %}
</span><span class='line'>  <span class="nt">&lt;section&gt;</span>
</span><span class='line'>    <span class="nt">&lt;h1&gt;</span>Comments<span class="nt">&lt;/h1&gt;</span>
</span><span class='line'>    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;comments&quot;</span> <span class="na">aria-live=</span><span class="s">&quot;polite&quot;</span><span class="nt">&gt;</span>{% include post/duoshuo.html %}<span class="nt">&lt;/div&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/section&gt;</span>
</span><span class='line'>{% endif %}
</span></code></pre></td></tr></table></div></figure>


<h2>增加duoshuo模板</h2>

<p>创建一个 source/_includes/post/duoshuo.html</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="c">&lt;!-- Duoshuo Comment BEGIN --&gt;</span>
</span><span class='line'><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;ds-thread&quot;</span> <span class="na">data-title=</span><span class="s">&quot;{% if site.titlecase %}{{ post.title | titlecase }}{% else %}{{ post.title }}{% endif %}&quot;</span><span class="nt">&gt;&lt;/div&gt;</span>
</span><span class='line'><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">duoshuoQuery</span> <span class="o">=</span> <span class="p">{</span><span class="nx">short_name</span><span class="o">:</span><span class="s2">&quot;{{ site.duoshuo_short_name }}&quot;</span><span class="p">};</span>
</span><span class='line'>  <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">ds</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;script&#39;</span><span class="p">);</span>
</span><span class='line'>    <span class="nx">ds</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s1">&#39;text/javascript&#39;</span><span class="p">;</span><span class="nx">ds</span><span class="p">.</span><span class="nx">async</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</span><span class='line'>    <span class="nx">ds</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="s1">&#39;http://static.duoshuo.com/embed.js&#39;</span><span class="p">;</span>
</span><span class='line'>    <span class="nx">ds</span><span class="p">.</span><span class="nx">charset</span> <span class="o">=</span> <span class="s1">&#39;UTF-8&#39;</span><span class="p">;</span>
</span><span class='line'>    <span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;head&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span class='line'>    <span class="o">||</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]).</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">ds</span><span class="p">);</span>
</span><span class='line'>  <span class="p">})();</span>
</span><span class='line'><span class="nt">&lt;/script&gt;</span>
</span><span class='line'><span class="c">&lt;!-- Duoshuo Comment END --&gt;</span>
</span></code></pre></td></tr></table></div></figure>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[事件驱动的伪任务-UOS]]></title>
    <link href="http://dofa.org/blog/2013/10/17/Event-driven-pseudo-task-UOS/"/>
    <updated>2013-10-17T00:00:00+00:00</updated>
    <id>http://dofa.org/blog/2013/10/17/Event-driven-pseudo-task-UOS</id>
    <content type="html"><![CDATA[<h3>protothread</h3>

<p>protothread是专为资源有限的系统设计的一种耗费资源特别少并且不使用堆栈的线程模型</p>

<h3>相比于嵌入式操作系统， protothread其有如下优点：</h3>

<ul>
<li>以纯C语言实现，无硬件依靠性； 因此不存在移植的困难</li>
<li>极少的资源需求，每个 Protothread 仅需要2个额外的字节</li>
<li>支持阻塞操纵且没有栈的切换</li>
</ul>


<h3>protothread的缺陷在于：</h3>

<ul>
<li>函数中不具备可重入型，不能使用局部变量；</li>
<li>按顺序判断各任务条件是否满足，因此无优先级抢占；</li>
<li>任务中的各条件也是按顺序判断的，因此要求任务中的条件必须是依次出现的。</li>
</ul>


<h3>Uos的核心便是protothread</h3>

<ul>
<li>Uos使用protothread实现Task Switch</li>
<li>Uos另外一个先进的地方：event-driven</li>
</ul>


<h3>Uos的Task Switch和event-driven</h3>

<ul>
<li>Task Switch负责把任务所有权切换出去</li>
<li>切换任务之前，要设置触发事件</li>
<li>任务调度时，会根据是否有触发事件发生，调用该任务</li>
</ul>


<h3>UOS项目官网</h3>

<ul>
<li>project网址：<a href="http://www.uos.co">http://www.uos.co</a></li>
<li>github网址：<a href="https://github.com/bitbegin/uos">https://github.com/bitbegin/uos</a></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[用-Jekyll-搭建个人博客]]></title>
    <link href="http://dofa.org/blog/2013/09/10/With-Jekyll-build-Personal-Blog/"/>
    <updated>2013-09-10T00:00:00+00:00</updated>
    <id>http://dofa.org/blog/2013/09/10/With-Jekyll-build-Personal-Blog</id>
    <content type="html"><![CDATA[<h3>使用理由</h3>

<ol>
<li> 使用 Markdown， 专心写博客，无样式排版烦恼</li>
<li> 使用自己喜欢的本地编辑器，本地随时写博客，可以本地预览，方便自己使用</li>
<li> 并使用 Git 管理博客，内容永不丢失</li>
<li> 可以部署在 github 上，不用自己购买管理 VPS，甚至域名也可以不买，对学生来说很适合</li>
<li> 没有第三方博客系统的广告，限制，随心而写</li>
</ol>


<h3>如何搭建</h3>

<ol>
<li> 由于 Jekyll 是用 Ruby 写的，因此首先要搭建 Ruby 执行环境，同时安装 git 版本控制工具</li>
<li> 在 Github 上创建一个仓库，仓库名为 <code>github 账户名.github.com</code> 或者 <code>github 账户名.github.io</code></li>
<li><p> 克隆仓库到本地，并初始化仓库。然后发布博客，第一次发布后大约需要 <code>十分钟</code> 就可以通过 <code>yourname.github.com</code> 访问博客了</p>

<pre><code>git clone https://github.com/yourname/yourname.github.com blog
cd blog
touch {README.md,index.html}        # 在 README.md 和 index.html 中加入内容
git add .
git commit -m "初始化提交"
git push origin master
</code></pre></li>
<li><p> 安装 Jekyll 规则搭建个人博客框架，具体参考 <a href="http://jekyllrb.com/" title="Jekyll 官方文档">Jekyll官方文档</a></p></li>
</ol>


<h3>Markdown 语法简记</h3>

<ul>
<li><code>1--6 级标题</code> 在行首使用 1-6 个 # 号</li>
<li><code>块引用</code> 在一段的第一行前面加上 > 表示一个区块引用， > 可以嵌套</li>
<li><code>列表</code> 无序列表 使用 *、 + 或是 &ndash; 作为列表标记，有序列表 则使用 数字接着一个英文句点</li>
<li><code>代码</code> 缩进 4 个空格 表示一个代码块， 使用 反引号（`）  标记一小段行内代码</li>
<li><code>强调</code> 用一个 * 或 _ 包围转成 &lt;em> 标签，用两个 * 或 _ 包围转成 &lt;strong> 标签，</li>
<li><code>分割线</code> 用三个以上的 *、 -、 _ 来建立一个分隔线，行内不能有其他东西</li>
<li><p><code>超链接和图片链接</code> 图片链接和超链接基本相同，图片链接多一个 ！。都有两种样式：行内式 和 参考式</p>

<pre><code>行内式：
    [潮汐猎人的博客](http://bitbegin.github.io "潮汐猎人的博客")

参考式：
    [潮汐猎人的博客][bitbegin]
    [bitbegin]: http://bitbegin.github.io "潮汐猎人的博客"        # 此行可以放在文章的任意位置
</code></pre></li>
<li><p><code>反斜杠和自动链接</code> 特殊字符可用 \ 转义； 把 网址 或 电子邮件信箱 用 &lt;> 包起来，会自动链接</p></li>
<li><p><code>表格</code> 不是 Markdown 的标准语法</p>

<pre><code>|     用户名     |     年龄    |
| -------------  | ----------- |
|     路人甲     |     21      |
|     路人乙     |     21      |
</code></pre></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[big endian与little endian（大小端）]]></title>
    <link href="http://dofa.org/blog/2013/08/05/big-endian-and-little-endian/"/>
    <updated>2013-08-05T13:25:52+00:00</updated>
    <id>http://dofa.org/blog/2013/08/05/big-endian-and-little-endian</id>
    <content type="html"><![CDATA[<p>在C编程中，经常遇到大小端（big endian与little endian）的问题，尤其涉及到位域的情况，很容易出错。我这里总结下C51和HTCC C18两种compiler对大小端的处理。</p>

<h2>Check Endian code</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="kt">char</span> <span class="nf">checkEndian</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="k">union</span> <span class="n">check</span><span class="p">{</span>
</span><span class='line'>      <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">a</span><span class="p">;</span>
</span><span class='line'>      <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">b</span><span class="p">;</span>
</span><span class='line'>  <span class="p">};</span>
</span><span class='line'>  <span class="k">union</span> <span class="n">check</span> <span class="n">ck</span><span class="p">;</span>
</span><span class='line'>  <span class="n">ck</span><span class="p">.</span><span class="n">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'>  <span class="k">return</span> <span class="p">(</span><span class="n">ck</span><span class="p">.</span><span class="n">b</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="k">union</span> <span class="n">uE</span><span class="p">{</span>
</span><span class='line'>      <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">num</span><span class="p">;</span>
</span><span class='line'>      <span class="k">struct</span><span class="p">{</span>
</span><span class='line'>          <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">a1</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
</span><span class='line'>          <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">b3</span><span class="o">:</span><span class="mi">3</span><span class="p">;</span>
</span><span class='line'>          <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">c16</span><span class="p">;</span>
</span><span class='line'>          <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">d3</span><span class="o">:</span><span class="mi">3</span><span class="p">;</span>
</span><span class='line'>          <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">e1</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span><span class="n">sN</span><span class="p">;</span>
</span><span class='line'>  <span class="p">};</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">union</span> <span class="n">uE</span> <span class="n">a</span><span class="p">;</span>
</span><span class='line'>  <span class="kt">char</span> <span class="n">ttt</span> <span class="o">=</span>    <span class="n">checkEndian</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">a</span><span class="p">.</span><span class="n">num</span> <span class="o">=</span> <span class="mh">0x12345678</span><span class="p">;</span>
</span><span class='line'>  <span class="n">a</span><span class="p">.</span><span class="n">num</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">a</span><span class="p">.</span><span class="n">sN</span><span class="p">.</span><span class="n">a1</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'>  <span class="n">a</span><span class="p">.</span><span class="n">sN</span><span class="p">.</span><span class="n">b3</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
</span><span class='line'>  <span class="n">a</span><span class="p">.</span><span class="n">sN</span><span class="p">.</span><span class="n">c16</span> <span class="o">=</span> <span class="mh">0x0304</span><span class="p">;</span>
</span><span class='line'>  <span class="n">a</span><span class="p">.</span><span class="n">sN</span><span class="p">.</span><span class="n">d3</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
</span><span class='line'>  <span class="n">a</span><span class="p">.</span><span class="n">sN</span><span class="p">.</span><span class="n">e1</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">a</span><span class="p">.</span><span class="n">num</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Executed results</h2>

<p>a.num = ?</p>

<p>对于big endian：</p>

<p>以C51来分析，结构成员按照定义顺序从小地址到大地址存放到ram中，显然按照地址从小到大排放结果就为：</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="mo">05</span> <span class="mo">03</span> <span class="mo">04</span> <span class="mi">0</span><span class="n">d</span>
</span></code></pre></td></tr></table></div></figure>


<p>转换为大端显示为：</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="mh">0x0503040d</span>
</span></code></pre></td></tr></table></div></figure>


<p>对于little endian：</p>

<p>结果为</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="mh">0x0d030405</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Results</h2>

<p>所以我这里结论：</p>

<ul>
<li><p>位域没有大小端的区别，区别在于各编译器的实现。上面的例子便是没有区别的compiler，C51和HTCC C18；网络字节序位域有大小端区别，这个一定要注意</p></li>
<li><p>两个及其以上字节有大小端区别</p></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[TCP/IP协议学习系列之三 — 链路层]]></title>
    <link href="http://dofa.org/blog/2013/08/01/tcp-ip-protocol-learning-series-three-of-link-layer/"/>
    <updated>2013-08-01T14:25:52+00:00</updated>
    <id>http://dofa.org/blog/2013/08/01/tcp-ip-protocol-learning-series-three-of-link-layer</id>
    <content type="html"><![CDATA[<h3>TCP/IP支持多种不同的链路层协议</h3>

<p>这取决于网络所使用的硬件，如以太网、令牌环网、FDDI（光纤分布式数据接口）及RS-232串行线路等。</p>

<h3>以太网是当今TCP/IP采用的主要的局域网技术</h3>

<p>它采用一种称作CSMA/CD的媒体接入方法，其意思是带冲突检测的载波侦听多路接入（Carrier Sense, Multiple Access with Collision Detection）。它的速率为10 Mb/s，地址为48 bit。</p>

<h3>以太网IP数据报的封装</h3>

<p>以太网IP数据报的封装是在RFC 894[Hornig 1984]中定义的，但存在另外一个IEEE 802规格RFC 1042[Postel and Reynolds 1988]，只是大多数人采用RFC 894。RFC 894在有的地方称作Ethernet-II。</p>

<h3>SLIP和PPP</h3>

<p>串行线路IP–SLIP和他的升级版PPP使用RS-232串口传数据，速度太慢，基本上大家都不用这种方式了，而改用宽带上网。这年头问别人如何上网，都是“你家多少兆？”。</p>

<h3>环回接口</h3>

<p>下面再来看一个大家都熟悉的ip：127.0.0.1。这个IP称作环回接口，它还有个英文名localhost。基本上，对这个ip的访问就是访问自己的主机。</p>

<h3>MTU</h3>

<p>以太网一次可以传送的最大传输单元（MTU）为1500B。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[TCP/IP协议学习系列之二 — Ethernet控制器]]></title>
    <link href="http://dofa.org/blog/2013/07/27/tcp-ip-protocol-learning-series-two-ethernet-directors/"/>
    <updated>2013-07-27T14:25:52+00:00</updated>
    <id>http://dofa.org/blog/2013/07/27/tcp-ip-protocol-learning-series-two-ethernet-directors</id>
    <content type="html"><![CDATA[<h2>硬件架构</h2>

<p>前面讲了，处理TCP/IP封包的硬件主要使用Ethernet模块。
大多数Ethernet模块分为这几个部分：PHY，MAC，MII/RMII管理，DMA和控制器。</p>

<ul>
<li>PHY实现bit流到cat5的transfer</li>
<li>MAC实现数据链路层的介质访问控制子层，并执行CSMA/CD功能</li>
<li>MII/RMII提供访问PHY的接口给MAC使用</li>
<li>DMA大家都懂得</li>
<li>控制器这里指的是协调MAC、MII/RMII管理、DMA的工具，不过一般也理解为Ethernet模块。比如PIC32中Ethernet控制器包括MAC、MII/RMII管理、DMA和SFR。</li>
</ul>


<h2>以太网原理—CSMA/CD</h2>

<p>CS：载波侦听
在发送数据之前进行监听，以确保线路空闲，减少冲突的机会。
MA：多址访问
每个站点发送的数据，可以同时被多个站点接收。
CD：冲突检测
边发送边检测，发现冲突就停止发送，然后延迟一个随机时间之后继续发送。</p>

<h2>以太网发展简史</h2>

<p>IEEE802.3 以太网标准
IEEE802.3u 100BASE-T快速以太网标准
IEEE802.3z/ab 1000Mb/s千兆以太网标准
IEEE802.3ae 10GE以太网标准</p>

<h2>相关技术</h2>

<h4>自协商技术</h4>

<p><img src="http://dofa.u.qiniudn.com/imgage/embeded/negotiation.bmp"></p>

<h4>自适应技术： 智能MDI/MDIX</h4>

<p>直连网线、交叉网线自动识别</p>

<h4>流量控制</h4>

<ul>
<li>当通过交换机一个端口的流量过大，超过了它的处理能力时，就会发生端口阻塞。流量控制的作用是防止在出现阻塞的情况下丢帧。</li>
<li>在半双工方式下，流量控制是通过反压（backpressure）技术实现的，模拟产生碰撞，使得信息源降低发送速度。</li>
<li>在全双工方式下流量控制一般遵循IEEE 802.3x标准。</li>
</ul>


<h4>全双工流量控制</h4>

<ul>
<li>IEEE802.3x标准定义了一种新方法，在全双工环境中去实现流量控制。交换机产生一个PAUSE帧，PAUSE帧使用一个保留的组播地址：01-80-C2-00-00-01，将它发送给正在发送的站，发送站接收到该帧后，就会暂停或停止发送。</li>
<li>PAUSE帧利用了一个保留的组播地址，它不会被网桥和交换机所转发，这样，PAUSE帧不会产生附加信息量。</li>
</ul>


<h2>MII接口介绍</h2>

<p>MII接口提供了MAC和PHY之间、PHY与STA（Station Management）之间的互联技术，该接口支持10Mb/s与100Mb/s的数据传输速率，数据传输的位宽为4位。
MII通过增加数据位宽实现参考时钟的降低。
MII接口主要包括4个部分：</p>

<ul>
<li>从MAC层到物理层的发送数据的接口</li>
<li>从物理层到MAC层的接受数据的接口</li>
<li>从物理层到MAC层的状态指示信号</li>
<li>MAC层和物理层之间传送控制和状态信息的MDIO接口</li>
</ul>


<p>MII接口可分为MAC模式和PHY模式，实际中主要用MAC模式，MAC模式的接口定义为：</p>

<p><img src="http://dofa.u.qiniudn.com/imgage/embeded/MII.bmp"></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[TCP/IP 协议学习系列之一 — 帧结构（frame）]]></title>
    <link href="http://dofa.org/blog/2013/07/26/tcp-ip-protocol-learning-series-one-of-frame-structure/"/>
    <updated>2013-07-26T14:25:52+00:00</updated>
    <id>http://dofa.org/blog/2013/07/26/tcp-ip-protocol-learning-series-one-of-frame-structure</id>
    <content type="html"><![CDATA[<h2>TCP/IP协议封包</h2>

<p>我觉得学习TCP/IP协议可以从它的封包开始，了解它在硬件上是怎么实现的是个不错的开端。</p>

<p><img src="http://dofa.u.qiniudn.com/imgage/embeded/tcpip-package.bmp"></p>

<p>上图是应用程序通过TCP/IP协议传输时的数据封包过程，该图基本反应了TCP/IP协议簇的数据打包过程。
封装好的IP协议一般通过硬件发送出去，比如Ethernet、令牌网、电话线。目前广泛应用的是Ethernet，我们的产品也不例外。</p>

<h2>Ethernet Frame结构</h2>

<p>我们看下Ethernet的帧结构：</p>

<p><img src="http://dofa.u.qiniudn.com/imgage/embeded/ethernet-frame.bmp"></p>

<p>基本上就是在TCP/IP封包基础上增加了一个Ethernet Frame Header和Frame Tail(CRC)。</p>

<p>这里的DA和SA指的是MAC，固定为6字节。类型/长度在不同的协议规格下有不同意义，Ethernet-II要求不小于0×8000的类型码，IEEE 802规格定义该字段为报文数据的长度。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Sublime Text的snippet]]></title>
    <link href="http://dofa.org/blog/2013/06/02/sublime-text-snippet/"/>
    <updated>2013-06-02T14:25:52+00:00</updated>
    <id>http://dofa.org/blog/2013/06/02/sublime-text-snippet</id>
    <content type="html"><![CDATA[<h2>snippet强大的自动补全功能</h2>

<p>以前理解代码自动补全以为就是函数或变量的自动补全，其实还可以是代码块的自动补全。接触过sublime text后才发现si的自动补全弱爆了，si也就阅读代码方便，写代码以后还要靠sublime text。话说sublime text的snippet就是自动补全，我也是今天才知道snippet。在简单的接触后，马上就可以实现自己的自动补全，不得不说st2真乃coding神器！</p>

<h2>Example：for语句的补全</h2>

<p>当匹配到<code>for</code>后，</p>

<p><img src="http://dofa.u.qiniudn.com/imgage/embeded/snippet-for.jpg">
输入<code>tab</code>，这时st2帮你输入以下代码：
<img src="http://dofa.u.qiniudn.com/imgage/embeded/snippet-for-tab.jpg">
当前光标会停留在<code>count</code>上，继续key字就会把<code>count</code>替换掉，接着按下<code>tab</code>会把<code>i</code>也替换掉。</p>

<h2>自定义snipppet</h2>

<p>通过<code>tools</code>&mdash;> <code>New snippet</code>，会出现：</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'><span class="nt">&lt;snippet&gt;</span>
</span><span class='line'>  <span class="nt">&lt;content&gt;</span><span class="cp">&lt;![CDATA[</span>
</span><span class='line'><span class="cp">Hello, ${1:this} is a ${2:snippet}.</span>
</span><span class='line'><span class="cp">]]&gt;</span><span class="nt">&lt;/content&gt;</span>
</span><span class='line'>  <span class="c">&lt;!-- Optional: Set a tabTrigger to define how to trigger the snippet --&gt;</span>
</span><span class='line'>  <span class="c">&lt;!-- &lt;tabTrigger&gt;hello&lt;/tabTrigger&gt; --&gt;</span>
</span><span class='line'>  <span class="c">&lt;!-- Optional: Set a scope to limit where the snippet will trigger --&gt;</span>
</span><span class='line'>  <span class="c">&lt;!-- &lt;scope&gt;source.python&lt;/scope&gt; --&gt;</span>
</span><span class='line'><span class="nt">&lt;/snippet&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>修改这行<code>&lt;!-- &lt;tabTrigger&gt;hello&lt;/tabTrigger&gt; --&gt;</code>为<code>&lt;tabTrigger&gt;hello&lt;/tabTrigger&gt;</code>就可以使用<code>hello+tab</code>调出<code>Hello, ${1:this} is a ${2:snippet}.</code>。光标首先会出现在<code>${1}</code>的位置上，<code>:this</code>表示<code>${1}</code>的默认值为<code>this</code>。</p>

<p>这里再给一个doxygen格式snippet配置：</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'><span class="nt">&lt;snippet&gt;</span>
</span><span class='line'>  <span class="nt">&lt;content&gt;</span><span class="cp">&lt;![CDATA[</span>
</span><span class='line'><span class="cp">/*!</span>
</span><span class='line'><span class="cp"> * \file ${1:file.c}</span>
</span><span class='line'><span class="cp"> * \brief this is a ${2:description} file</span>
</span><span class='line'><span class="cp"> * \author bitbegin</span>
</span><span class='line'><span class="cp"> * \date ${3:2013-6-3}</span>
</span><span class='line'><span class="cp"> * \version V1.0.061</span>
</span><span class='line'><span class="cp"> * \note this is a ${2:description} file</span>
</span><span class='line'><span class="cp"> * \warning Only for bitbegin</span>
</span><span class='line'><span class="cp"> * \details</span>
</span><span class='line'><span class="cp"> * ${4:your details}</span>
</span><span class='line'><span class="cp"> *</span>
</span><span class='line'><span class="cp"> */</span>
</span><span class='line'><span class="cp">]]&gt;</span><span class="nt">&lt;/content&gt;</span>
</span><span class='line'>  <span class="c">&lt;!-- Optional: Set a tabTrigger to define how to trigger the snippet --&gt;</span>
</span><span class='line'>  <span class="nt">&lt;tabTrigger&gt;</span>doxy-file<span class="nt">&lt;/tabTrigger&gt;</span>
</span><span class='line'>  <span class="c">&lt;!-- Optional: Set a scope to limit where the snippet will trigger --&gt;</span>
</span><span class='line'>  <span class="c">&lt;!-- &lt;scope&gt;source.python&lt;/scope&gt; --&gt;</span>
</span><span class='line'><span class="nt">&lt;/snippet&gt;</span>
</span></code></pre></td></tr></table></div></figure>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Sublime Text的一些快捷键]]></title>
    <link href="http://dofa.org/blog/2013/06/01/some-short-keys-of-sublime-text/"/>
    <updated>2013-06-01T19:25:52+00:00</updated>
    <id>http://dofa.org/blog/2013/06/01/some-short-keys-of-sublime-text</id>
    <content type="html"><![CDATA[<h2>打开/前往</h2>

<pre><code>Ctrl+P：搜索项目中的文件
Ctrl+G：跳转到第几行
Ctrl+R：前往 method
Ctrl+;：前往字段
Ctrl+Shift+P：打开命令面板
Ctrl+N：新建窗口
Ctrl+o：打开文件
Ctrl+shift+s：另存为
Ctrl+W：关闭当前打开文件
Ctrl+Shift+W：关闭所有打开文件
Ctrl+`：显示python命令行
</code></pre>

<h2>界面</h2>

<pre><code>F11 全屏
shift+F11：无干绕全屏
ctrl+kb：开关侧边栏
Alt+Shift+数字：分屏显示
ctrl+I：显示底部面板
</code></pre>

<h2>编辑</h2>

<pre><code>F6：拼写检查
F9：行排序
</code></pre>

<p>选择类</p>

<pre><code>ctrl+l：选择整行（继续按键则选择下行）
ctrl+shift+l：将光标放至选中单行内容末尾或多行内容每行行尾
ctrl+d：选中光标位置所在单词 （继续按键则选择下个相同的字符串）
ctrl+m：光标移动至括号内开始或结束的位置
ctrl+shift+m：选择括号内的内容（继续按键则选择父括号）
Alt+F3：选择所有相同的词
Shift+右键拖动：光标多不，用来更改或插入列内容
Ctrl+鼠标左键：依次点击或选取，可需要编辑的多个位置
ctrl+shfit+space：选择本范围
ctrl+alt+上下箭头：多竖行同时编辑
</code></pre>

<p>代码折叠</p>

<pre><code>ctrl+shift+[：按照缩进指示折叠光标所在标签对或折叠所选内容
ctrl+shift+]：展开光标所在标签对内容或所选内容
</code></pre>

<p>行操作</p>

<pre><code>ctrl+kk：从光标处删除至行尾
ctrl+k+backspace：从光标处删除至行首
ctrl+shift+k：删除整行
ctrl+shift+backspace：删除整行
ctrl+shift+up：光标所在行与上行互换
ctrl+shift+down：光标所在行与下行互换
ctrl+shift+d：复制光标所在整行，插入在该行之前
ctrl+enter：在当前行后插入新行
ctrl+shift+enter：在当前行前插入新行
ctrl+[：减少当前行缩进
ctrl+]：增加当前行缩进
tab：增加当前行缩进
shift+tab：减少当前行缩进
</code></pre>

<p>常用编辑</p>

<pre><code>ctrl+u：软撤销
ctrl+z：撤销
ctrl+y：恢复撤销
ctrl+backspace：删除一个单词
ctrl+ku：改为大写
ctrl+kl：改为小写
ctrl+x：选定内容状态下为剪切内容，未选中为剪切光标当前所在行
ctrl+t：光标所在位置左右字符或词互换
Ctrl+Shift+V：粘贴并格式化
Alt + Ctrl + ]：代码自动对齐
</code></pre>

<h2>拆分窗口/标签页</h2>

<pre><code>alt+.：闭合当前标签
Alt+Shift+数字：分屏显示
ctrl+tab：切换选项卡
ctrl+shift+tab：逆序切换选项卡
Alt+数字：切换打开第N个文件
</code></pre>

<h2>标记</h2>

<pre><code>Ctrl+F2：设置/删除标记
</code></pre>

<h2>查找/替换</h2>

<pre><code>Ctrl+F：查找内容
Ctrl+Shift+F：查找并替换
Ctrl+H：替换
F3：查找下一个
shift+F3：查找前一个
</code></pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Sublime Text 学习笔记]]></title>
    <link href="http://dofa.org/blog/2013/06/01/sublime-text-study-notes/"/>
    <updated>2013-06-01T16:25:52+00:00</updated>
    <id>http://dofa.org/blog/2013/06/01/sublime-text-study-notes</id>
    <content type="html"><![CDATA[<ul>
<li>如果你的配置错误，导致Sublime Text2不能打开了，想要把配置改回来，那么配置文件在C:\Users\用户名\AppData\Roaming\Sublime Text 2\Packages\User中</li>
<li>安装Package control，按快捷键Ctrl+`，打开命令输入界面（一般在下方），输入下面的命令后回车即可，重启Sublime Text2</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="kn">import</span> <span class="nn">urllib2</span><span class="o">,</span><span class="nn">os</span><span class="p">;</span><span class="n">pf</span><span class="o">=</span><span class="s">&#39;Package Control.sublime-package&#39;</span><span class="p">;</span><span class="n">ipp</span><span class="o">=</span><span class="n">sublime</span><span class="o">.</span><span class="n">installed_packages_path</span><span class="p">();</span><span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">ipp</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">ipp</span><span class="p">)</span> <span class="k">else</span> <span class="bp">None</span><span class="p">;</span><span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ipp</span><span class="p">,</span><span class="n">pf</span><span class="p">),</span><span class="s">&#39;wb&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">urllib2</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="s">&#39;http://sublime.wbond.net/&#39;</span><span class="o">+</span><span class="n">pf</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">,</span><span class="s">&#39;%20&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>修改字体
Preferences->File Setting-User，打开配置文件，看里面有没font_face配置项，有就直接改，没有就自己加上，可能的配置文件如下：</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="s">&quot;color_scheme&quot;</span><span class="p">:</span> <span class="s">&quot;Packages/Color Scheme - Default/Black-Pearl2.tmTheme&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="s">&quot;font_face&quot;</span><span class="p">:</span> <span class="s">&quot;微软雅黑&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="s">&quot;font_size&quot;</span><span class="p">:</span> <span class="mf">10.0</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>设置代理(GoAgent)
打开<code>settings - user</code>，输入：</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="s">&quot;http_proxy&quot;</span><span class="p">:</span> <span class="s">&quot;http://127.0.0.1:8087&quot;</span><span class="p">,</span>
</span><span class='line'><span class="s">&quot;https_proxy&quot;</span><span class="p">:</span> <span class="s">&quot;http://127.0.0.1:8087&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li><p>同时编辑多行 (Ctrl+Shift+L (Win) 或  Command+Shift+L (Mac))
如要在选中的多行文本的最后面同时添加一个字符“a”，先选中要编辑的多行文字，然后按快捷键，此时每行的末尾都会有个输入光标在闪，再按End键将鼠标定位到行末，（再按Home键将鼠标定位到行首）输入字母a即可。如要退出多行编辑状态，按Esc键即可。</p></li>
<li><p>一次性选择全部的相同文本 (Alt+F3 (Win) 或 Ctrl+Command+G (Mac))</p></li>
<li><p>竖向多行选择 (Shift+鼠标右键 (Win) 或 Option+鼠标左键 (Mac))</p></li>
<li><p>手动选择多处不同文本 (Ctrl+鼠标左键(Win) 或 Command+鼠标左键(Mac) )</p></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Sublime Text 入门及技巧]]></title>
    <link href="http://dofa.org/blog/2013/06/01/sublime-text-guide-and-tips/"/>
    <updated>2013-06-01T14:25:52+00:00</updated>
    <id>http://dofa.org/blog/2013/06/01/sublime-text-guide-and-tips</id>
    <content type="html"><![CDATA[<h2>快捷的命令面板</h2>

<p>和 TextMate 类似，Sublime Text 2 也提供了很方便的命令调用方式：Command Palette（命令面板）。调用方法：直接在 <code>Tool</code> 菜单中选择 <code>Command Palette</code>，或是用快捷键：<code>Shift+Command+P</code>，输入命令名称（中的字母）就可以实时搜索到相应的命令、选项、snippet 和 syntex， 按下回车就可以直接执行，减少了查找的麻烦。</p>

<h2>即时的文件切换</h2>

<p>按下 <code>Command+P</code>(Mac) 或是 <code>Ctrl+P</code>(Windows)，输入想要切换到的文件的文件名，都不用按下回车键，目标文件就已经展现在眼前了，虽然 Vim 配合 PeepOpen 也可以实现同样的功能，但速度却远没有这么迅速。</p>

<h2>随心所欲的跳转</h2>

<p><code>Cmd+P</code> 之所以被叫做 Goto Anything 并不是虚名：</p>

<ul>
<li>用 <code>Command+P</code> 可以快速跳转到当前项目中的任意文件，可进行关键词匹配。</li>
<li>用 <code>Command+P</code> 后 <code>@</code> (或是<code>Command+R</code>)可以快速列出/跳转到某个函数（很爽的是在 markdown 当中是匹配到标题，而且还是带缩进的！）。</li>
<li>用 <code>Command+P</code> 后 <code>#</code> 可以在当前文件中进行搜索。</li>
<li>用 <code>Command+P</code> 后 <code>:</code> (或是<code>Ctrl+G</code>)加上数字可以跳转到相应的行。</li>
</ul>


<p>而更酷的是你可以用 <code>Command+P</code> 加上一些关键词跳转到某个文件同时加上 <code>@</code> 来列出/跳转到目标文件中的某个函数，或是同时加上 <code>#</code> 来在目标文件中进行搜索，或是同时加上 <code>:</code> 和数字来跳转到目标文件中相应的行。</p>

<h2>多重选择(Multi-Selection)</h2>

<p>多重选择功能允许在页面中同时存在多个光标，让很多本来需要正则表达式、高级搜索和替换才能完成的任务也变得游刃有余了。
激活多重选择的方法有两几种：</p>

<ul>
<li>按住 <code>Command</code> 或 <code>Alt</code>，然后在页面中希望中现光标的位置点击。</li>
<li>选择数行文本，然后按下 <code>Shift+Command+L</code>。</li>
<li>通过反复按下 <code>Control/Command+D</code> 即可将全文中与光标当前所在位置的词相同的词逐一加入选择，而直接按下 <code>Alt+F3</code>(Windows) 或是 <code>Ctrl+Command+G</code>(Mac) 即可一次性选择所有相同的词。</li>
<li>按下鼠标中键来进行垂直方向的纵列选择，也可以进入多重编辑状态。</li>
</ul>

]]></content>
  </entry>
  
</feed>
